apiVersion: 0.6.0

meta:
  name: slack-package
  version: 0.0.1
  namespace: examples

types:
  slack-event:
    type: object
    properties:
      blocks:
        type: list
        type-name: slack-event-blocks
        items:
          type: enum
          type-name: slack-event-untagged
          tagging: untagged
          oneOf:
            text-section:
              type: text-section
            fields-section:
              type: fields-section
  slack-obj:
    type: object
    properties:
      fields:
        type: list
        type-name: slack-obj-fields
        items:
          type: string
      title:
        type: string
  text-section:
    type: object
    properties:
      text:
        type: text-object
      type:
        type: enum
        type-name: text-section-type
        oneOf:
          section:
            type: null
  fields-section:
    type: object
    properties:
      fields:
        type: list
        type-name: fields-section-fields
        items:
          type: text-object
      type:
        type: enum
        type-name: fields-section-type
        oneOf:
          section:
            type: null
  text-object:
    type: object
    properties:
      text:
        type: string
      type:
        type: enum
        type-name: text-object-type
        oneOf:
          mrkdwn:
            type: null

functions:
  ## Function to turn fields-obj into a slack-event
  make-slack-fields-event:
    operator: map
    inputs:
      - name: obj
        type: slack-obj
    output:
      type: slack-event

  ## Test API to ensure proper decoding/enocoding of Slack Events
  test-event:
    operator: map
    inputs:
      - name: sev
        type: slack-event
    output:
      type: slack-event