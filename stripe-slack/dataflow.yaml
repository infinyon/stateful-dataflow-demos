apiVersion: 0.6.0
meta:
  name: stripe-dataflow
  version: 0.1.0
  namespace: examples

config:
  converter: json
  consumer:
    default_starting_offset:
      value: 0
      position: End  

imports:
  - pkg: examples/stripe@0.0.1
    types:
      - name: stripe-event
  - pkg: examples/slack@0.0.1
    types:
      - name: slack-event
  - pkg: examples/stripe-slack@0.0.1
    functions:
      - name: stripe-to-slack

topics:
  stripe-events:
    schema:
      value:
        type: stripe-event

  slack-billing-events:
    schema:
      value:
        type: slack-event

services:
  stripe-to-slack:
    sources:
      - type: topic
        id: stripe-events

    transforms:
      - operator: map
        uses: stripe-to-slack

    sinks:
      - type: topic
        id: slack-billing-events

dev:
  imports:
    - pkg: examples/stripe@0.0.1
      path: ../packages/stripe
    - pkg: examples/slack@0.0.1
      path: ../packages/slack
    - pkg: examples/stripe-slack@0.0.1
      path: ../packages/stripe-to-slack
